<!doctype html>
<html lang="Pt-Br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="script.js"></script>

    <title>PrincipalRotaSegura</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="modal.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

          <script>

            var usuariologado = localStorage.getItem('usuariologado');

            console.log(usuariologado)
          </script>


          <style>


          @keyframes fadeIn {
            0% {
              opacity: 0;
            }
            100% {
              opacity: 1;
            }
          }

          </style>

  </head>

<body>

  <header>

  <div class="row">
    
    <div class="col-sm-12">
      <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">

            <li class="nav-item" style = "margin-left: 20px;">
              <a class="nav-link active" aria-current="page" href="main.html">Home</a>
            </li>

            <li class="nav-item" style = "margin-left: 40px;">
            <a class="nav-link" href="perfil.html">Perfil</a>
            </li>

            <li class="nav-item" style = "margin-left: 60px;">

            <button type="button" class="btn btn-primary" onclick="openModal()">Novo Grupo</button>
            </li>

            <li class="nav-item">

              <button type="button" class="btn btn-primary" style="background-color: brown; border-color: brown; margin-left: 900px;" onclick="logout()">Sair</button>

            </li>
            

          </ul>
      </nav>
</div>

</header>

<main>

<div class="container text-center">

  
      <center>
      <div class="card" style="width: 52rem; height: 40rem;">
      <center>
        <img src="etepdlogo.jpg" class="card-img-top" alt="..." style="width: 300px; justify-content: center; margin-bottom: 50px;">
      </center>
        <div class="card-body" id="mainContainer">
          <!-- <h5 class="card-title"> Trajeto Seguro </h5>
          <br>
          <p class="card-text">Destino: </p>
          <!-- Elemento textual com Id da informação do destino
          <p class="card-text">Modalidade: </p>
          <!--Elemento textual com Id da informação de modal
          <p class="card-text">Grupo de Carona de: </p>
          <!--Elemento textual com Id da informação do nome do dono do grupo
          <p class="card-text">Horário: </p>
          <!--Elemento textual com Id do horário
          <p class="card-text">Vagas Disponíveis: </p>
          <!--Elemento textual com Id das vagas disponíveis
          <label for="SolicitarConvite" class="form-label"></label>
          <input type="text" class="form-control" id="SolicitarConvite" placeholder="Escreva sua mensagem com seu nome, se é aluno ou funcionário e destino para solicitar convite para o grupo">
          <br>
          <a href="https://www.google.com" class="btn btn-primary">Link do Grupo</a> -->
          <!--Inserir elemento que contem o link do whatsapp com uma mensagem no seguinte estilo "Olá, sou o [NOME], sou [ESTUDANTE OU FUNCIONÁRIO DA ETEPD], gostaria de entrar no seu grupo de carona para [DESTINO]"--> 
        </div>
      </div>
      </center>
    </div>






    
     
    </div>
  </div>
</div>

<div class="modal-container">
  <div class="modal">
    <h2>Crie seu Grupo</h2>
    <hr />
    <span> 
  <form class="row g-3">
    <div class="col-md-6">
      <label for="cnome" class="form-label">Seu Nome</label>
      <input type="text" class="form-control" id="cnome" placeholder="Digite seu nome">
    </div>
    <div class="col-md-6">
      <label for="ctransporte" class="form-label">Tipo de Transporte</label>
      <input type="text" class="form-control" id="ctransporte" placeholder="Com que transporte vamos">
    </div>
    <div class="col-12">
      <label for="cdestino" class="form-label">Destino</label>
      <input type="text" class="form-control" id="cdestino" placeholder="Para onde vamos">
    </div>
    <div class="col-12">
      <label for="cvagas" class="form-label">Quantidade inicial de vagas</label>
      <input type="number" class="form-control" id="cvagas">
    </div>
    <div class="col-md-8">
      <label for="cgrupo" class="form-label">Link do Grupo</label>
      <input type="text" class="form-control" id="cgrupo" placeholder="Crie um grupo de Whatsapp e insira o link">
    </div>
    <div class="col-md-4">
      <label for="chorario" class="form-label">Horário de saída</label>
      <input type="text" class="form-control" id="chorario" placeholder="21:00">
      </select>
    </div>
      </span>
      <hr />
      <div class="btns">
        <button type="submit" class="btn btn-primary" onclick="cadastrodegrupo()">Criar Grupo</button>
        <button class="btnClose" onclick="closeModal()">Fechar</button>
    </div>
  </div>
</form>
</div>
<!--Aqui precisamos inserir uma função para que os dados inseridos vão para o banco de dados e reflitam na lista de grupos da pagina-->
<script src="criargrupo.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
  // Check if a user is logged in when the page loads
  window.onload = function() {
    
    updateGroupList();
    let loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
    console.log(usuariologado);
    if (!loggedInUser) {
      // If no user is logged in, redirect to the login page
      window.location.href = 'index.html';
    }
  };

  function updateGroupList() {
    // Get the group database from localStorage
    let db = JSON.parse(localStorage.getItem('groupDb')) || [];

    // Get the container element where the group list will be displayed
    let container = document.getElementById('mainContainer');

    // Clear the container
    container.innerHTML = '';

    // Loop through the group database and create a card for each group
    for(let i = 0; i < db.length; i++) {
        let group = db[i];
        let card = document.createElement('div');
        card.className = 'card';
        if (usuariologado == group.donodogrupo) {

        
        card.innerHTML = `

            <div class="card-body" style = "animation: fadeIn 3s ease-in-out;">
          
                <h5 class="card-title">${group.nome}</h5>
                <p class="card-text">Destino: ${group.destino}</p>
                <p class="card-text">Modalidade: ${group.transporte}</p>
                <p class="card-text">Horário: ${group.horario}</p>
                <p class="card-text">Vagas Disponíveis: ${group.vagas}</p>
                <a href="${group.grupo}" class="btn btn-primary">Link do Grupo</a>
                <button class="btn btn-danger" onclick="deleteGroup(${i})">Excluir grupo</button>
            </div>
        `;


      }

      else {

        card.innerHTML = `
            <div class="card-body" style = "animation: fadeIn 3s ease-in-out;">
                <h5 class="card-title">${group.nome}</h5>
                <p class="card-text">Destino: ${group.destino}</p>
                <p class="card-text">Modalidade: ${group.transporte}</p>
                <p class="card-text">Horário: ${group.horario}</p>
                <p class="card-text">Vagas Disponíveis: ${group.vagas}</p>
                <a href="${group.grupo}" class="btn btn-primary">Link do Grupo</a>
            </div>
        `;

      }
        container.appendChild(card);
    }
}


</script>


</main>

<footer class="footer fixed-bottom bg-primary text-white">
  <div class="container">
    <div class="row">
      <div class="col-sm-6">
        <p class="text-left" style="text-align: left;">ETE Porto Digital - 2024</p>
      </div>
      <div class="col-sm-6">
        <p class="text-right" style="text-align: right;">Projeto RotaSegura - 2024</p>
      </div>
    </div>
  </div>
</footer>




</body>


</html>